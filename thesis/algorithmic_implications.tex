\chapter{Algorithmic Implications}

\section{Computational Complexity}

\begin{corollary}
	Computing the minimum altitude in the inverse simplex of a graph is an NP-hard optimization problem. 
\end{corollary}
\begin{proof}
	Follows from the fact that computing the maximum weighted cut is NP-hard. 
\end{proof}


\paragraph{Independent Set}
Let $I\subset V$ be an independent set in $G$, i.e., if $i,j\in I$ then $(i,j)\notin E$. Consider 
\begin{align*}
    \Lf(\chi_I) = \sum_{i\sim j}w(i,j)(\chi_I(i)-\chi_I(j))^2 = \sum_{i\in I}\sum_{j:j\sim i} w(i,j) = \sum_{i\in I}w(i)=W(\delta I),
\end{align*}
where the second and fourth inequalities follows from the fact that $I$ is an independent set. 

Suppose we assign each vertex $i$ a weight $f(i)\geq 0$. The \mwis problem consists of maximizing $f(I)\equiv \sum_{i\in I}f(i)$ over all independent sets $I$. Clearly \mwis is NP-hard, seeing as it reduces to the usual independent set maximization problem by taking $f(i)=1$ for all $i$. 

Suppose $f(i)=\alpha w(i)$ for all $i$, i.e., we assign the vertex weights as a linear function of their total edge weight. For an independent set $I$ we have 
\begin{align*}
    f(I) = \alpha w(I)= \alpha W(\delta I) = \alpha \frac{|I|}{\norm{c(\splx_I)}_2^2}.
\end{align*}
In the simplex, the criteria that $I$ is an independent set translates to the property that $\la \sv_i,\sv_j\ra =0$ for all $i,j\in I$. We can thus say something \TODO \note{What? Need to decide whether problem is easy or hard} about the constrained optimization problem 
\begin{alignat*}{2}
    \min_I & \quad && \frac{\norm{c(\splx_I)}_2^2}{|I|} \\
    \text{s.t.} & && \la \sv_i,\sv_j\ra =0, \;i,j\in I.
\end{alignat*}

The normalized Laplacian, meanwhile, removes the weights from consideration. For an independent set $I$ and a vertex $i\in I$ note that $W(\delta(i)\cap I^c)=w(i)$ since $\delta(i)\cap I^c=\delta(i)$ by definition of an independent set. Therefore, Equation \eqref{eq:Lnf(chiU)} yields 
\begin{align*}
    \Lnf(\chi_I)=\sum_{i\in I}\frac{W(\delta(i)\cap I^c)}{w(i)} = |I|,
\end{align*}
implying that 
\[\norm{c(\splxn_I)}_2^2=\frac{1}{|I|^2}\Lnf(\chi_I)=\frac{1}{|I|}.\]
Since maximizing the cardinality of an independent set is an NP-hard problem, we have that 

\begin{alignat*}{2}
\max_I & \quad &&  \norm{c(\splxn_I)}_2^2 \\
 \text{s.t.}&  &&  \la \sv_i,\sv_j\ra=0,\; i,j\in I,
\end{alignat*}
is an NP-hard problem.


\begin{theorem}
Deciding whether two polytopes are isomorphic is Graph-Isomorphism-Hard. Moreover, subpolytope isomorphism is NP-hard. 
\end{theorem}

The first result was also proved in \cite{kaibel2008complexity}. 

\note{Formulate MST in terms of hyperacute simplices. Seems somewhat surprising that this high-dimensional geometric problem is solvable in poly time. On the other hand, what seems like a related problem in "geometric" space, Hamiltonian cycle/path, is hard. Probably worth mentioning but not thinking too much about.}

\section{There and Back Again: Transitioning Between Simplices}
In this section we investigate the computational aspects of transitioning between various simplices and between the graph and its simplices. We are interested in obtaining computational results which are strictly sub-cubic in time, i.e., $o(n^3)$ because in cubic time one can solve linear systems and compute eigendecompositions. Thus, for instance, given $G$ it is trivial to compute all of $\splx_G,\splx^+_G,\splxn_G$, and $\splxn_G^+$ by finding the eigendecomposition (which takes cubic time) of $\L_G$ from which we can construct the relevant vertex set.  Moreover, starting with a simplex with vertex set $\Sv$, one can compute $\Sv^\tp\Sv$ in cubic time. If the simplex is the simplex if a graph then this yields the Laplacian (or the pseudoinverse of the Laplacian) of the graph, which as above allows us to compute any of the simplices. In what follows therefore, we attempt to beat the barrier of $O(n^3)$. 

A question which is raised by the above discussion is one of certifying whether a given simplex $\ssplx$ is the combinatorial, normalized, or one of their duals of some graph $G$. Again, in cubic time we can compute $\Sv^\tp\Sv$ and thus decide whether $\Sv^\tp\Sv$ is equal to $\L_G$ for some graph $G$. In quadratic time we can check whether all the angles $\theta_{ij}$ between the faces $\ssplx_\ic$ and $\ssplx_\jc$ are non-obtuse, in which case $\ssplx$ is the inverse simplex of some graph. Beyond computing $\Sv(\ssplx)^\tp \Sv(\ssplx)$ however, it's not clear how to obtain the original graph or the combinatorial simplex. 

\subsection{Between \texorpdfstring{$\splx$}{the combinatorial} and \texorpdfstring{$\splxn$}{normalized simplex.}}
Let us consider the computational complexity of transitioning between $\splx$ and $\splxn$ and vice versa. Let $\phi_{ij}$ (resp., $\phin_{ij}$) be the angle between $\sv_i$ and $\sv_j$ (resp., $\svn_i$ and $\svn_j$). Using the typical formula for the dot product in Euclidean space we have
\begin{equation*}
\cos\phi_{ij} = \frac{\la \sv_i,\sv_j\ra }{\norm{\sv_i}_2\norm{\sv_j}_2} = \frac{\L_G(i,j)}{\sqrt{w(i)w(j)}} = \Ln_G(i,j), \quad\text{and}\quad \cos\phin_{ij} = \frac{\la \svn_i,\svn_j\ra }{\norm{\svn_i}_2\norm{\svn_j}_2} = \Ln_G(i,j),
\end{equation*}
using that $\norm{\svn_i}_2=1$ for all $i$. 
That is, the angles between vertices in $\splx$ in $\splxn$ are the same. Suppose we are given the simplex $\splx$ and told it is the combinatorial simplex of a graph. For each $\sv_i = \Sv(\splx)$, define a new vertex 
\[\bgamma_i = \frac{\sv_i}{\norm{\sv_i}_2}.\]
Is it evident that the angle between $\bgamma_i$ and $\bgamma_j$ is identical to that between $\sv_i$ and $\sv_j$: 
\begin{equation*}
\frac{\la \bgamma_i,\bgamma_j\ra}{\norm{\bgamma_i}_2\norm{\bgamma_j}_2} = \bigg\la \frac{\sv_i}{\norm{\sv_i}_2},\frac{\sv_j}{\norm{\sv_j}_2}\bigg\ra = \cos(\phi_{ij}).
\end{equation*}
Therefore, it follows that the simplex with vertices is congruent  to $\splxn$. This yields the following result. 

\begin{lemma}
	Given a combinatorial simplex $\splx$, a simplex congruent to $\splxn$ can be computed in time $O(n^2)$. 
\end{lemma}
\begin{proof}
	Given $\splx$, define the vertices $\bgamma_i$ as above. Computing $\norm{\sv_i}_2$ takes time $O(n)$ and must be done for each vertex. 
\end{proof}

Given the relative ease with which we can transition from $\splx$ to $\splxn$, it is somewhat surprising that it is much more difficult to transition from $\splxn$ to  $\splx$, especially if the underlying graph $G$ is not given. The obvious tactic is, given the vertices $\{\svn_i\}$, to define vertices $\svn_i \sqrt{w(i)}$, which, since $\sqrt{w(i)}=\norm{\sv_i}_2$, have the same magnitude as $\sv_i$. As above, the scaling does not affect the angle between the vertices, and thus the simplex with these vertices is congruent to $\splx$. However, it's not clear how to obtain the value $\sqrt{w(i)}$ from $\splxn$. Using that $\la \svn_i,\svn_j\ra =(w(i)w(j))^{-1/2}$ we can write 
\[w(i)^{1/2} = -\sum_{j\neq i}w(j)^{-1/2} \bigg/ \sum_{j\neq i}\la \svn_i,\svn_j\ra,\]
which yields a non-linear system of equations. 

Of course, if we are given the graph then we have access to $\sqrt{w(i)}$ and can compute $\svn_i w(i)^{1/2}$ in time $O(n)$. The following result is then immediate. 

\begin{lemma}
	Given a graph $G=(V,E,w)$ and its normalized simplex $\splxn_G$, a simplex congruent to  the combinatorial simplex $\splx_G$ can be computed in $O(n^2)$ time. 
\end{lemma}

\note{Think about possible lower bounds on computing $\splx$ from $\splxn$ when no graph is given. Doing so would imply knowledge of $\sqrt{\w}$ (taking ratio of lengths of vertices). What does this imply? Does knowledge of $\w$ give us some knowledge of the graph structure from which we can extract a lower bound? }



\subsection{\texorpdfstring{$\splx$}{The combinatorial} and \texorpdfstring{$\splx^+$}{normalized simplex}.}

Let us suppose that we can generate $\splx^+$ from $\splx$ (or vice versa) in time $O(g(n))$. Note that for $i<n$, 
\[\lambda_i = \frac{\lambda_i^{1/2} \vp_j(i)}{\lambda_i^{-1/2}\vp_j(i)} = \frac{\sv_i(j)}{\sv_i^+(j)}, \quad \text{and} \quad \vp_i(j) = \frac{\sv_j(i)}{\lambda_i^{1/2}},\]
hence knowledge of $\{\sv_i\}$ and $\{\sv_i^+\}$ yields knowledge of the eigendecomposition of the underlying graph $G$ in $O(n^2)$ time ($O(n)$ to determine all the  eigenvalues and $O(n^2)$ to determine the eigenvectors). The same argument holds \emph{mutatis mutandis} for the normalized Laplacian. 

\begin{lemma}
	If $\splx^+$  (resp., $\splxn^+$) can be generated from $\splx$ (resp., $\splxn$) or vice versa in time $O(g(n))$, then \lapdecomp can be solved in time $O(g(n) + n^2)$ for arbitrary weighted graphs. 
\end{lemma}

It is therefore unlikely that $g(n) = o(n^2)$. 

An alternate way of seeing that constructing the inverse simplex from its dual is computationally challenging is to recall from Section \ref{sec:S_G} that $\splx_\ic$ is contained in the hyperplane $\{\x\in\R^{n-1}:\la \x,\sv_i^+\ra = -1/n\}$ (Lemma \ref{lem:SUsubset})
 and that that $\sv_i^+$ is perpendicular to $\splx_\ic$ (Lemma \ref{lem:faces_orthogonal}). Hence, computing the inverse simplex would imply that we had computed normal vectors to $n$ hyperplanes, the typical procedure for which typically involves computing an $n\times n$ determinant and requires  $O(n^3)$ time. 
 
 One might at least hope that we could approximate the inverse simplex given the original simplex. 











\note{Therefore, if we can show that: For any hyperplane there exists a simplex with a face parallel to the hyperlane, then we can obtain a lower bound in terms of computing normals to hyperplanes.} 

We can, however, estimate the distance matrix of the inverse simplex by appealing to the result of Spielman and Teng~\cite{spielman2011graph} demontrating how to quickly approximate the effective resistances. As we've noted before, $w(i) = \norm{\sv_i}_2^2$ can be computed in linear time, hence $W^{1/2}$ can be computed in $O(n^2)$ time. The number of edges c








\subsection{Between \texorpdfstring{$G$}{the graph} and \texorpdfstring{$\splx$ or $\splxn$}{its simplices}}



\section{Approximations and Embeddings} 

\subsection{Low Rank Approximation}

\note{Define low rank approximation}
Let us suppose the we have obtained a low rank---$k$, say---approximation of $\L_G$, written $\tL$. We might then ask several questions: 
\begin{enumerate}
	\item Is $\tL$ still a gram matrix? That is, can $\tL$ be written $\tSv^\tp\tSv$ where $\tSv$ is the vertex matrix of some set of points, $P=\{\p_1,\dots,\p_\ell\}$? If so, what is the relationship between $\Sv$ and $\tSv$, where $\Sv=\Sv(\splx_G)$ is the usual vertex matrix of the combinatorial simplex of $G$? If $\tL$ has rank $k$ then $P$ spans a subspace of dimension $k$ and $\conv(P)$ forms a polytope in that space. What is the relationship between the geometry of $\conv(P)$ and $\splx_G$?
	\item Is $\tL$ useful in helping estimate properties of the simplex $\splx_G$? For example, if one could bound the difference in the quadratic products of $\L_G$ and $\tL$, this would imply (via the results in Section \ref{sec:S_G}) that we could estimate many of the properties of $\splx_G$. 
	\end{enumerate}

Of course, we have chosen to work with $\L_G$ and $\splx_G$ for convenience; we could have asked the same questions of $\Ln_G$ and $\splxn_G$. 

Let us examine a specific low rank approximation proposed by Drineas and Mahoney~\cite{drineas2005approximating}, which finds low rank approximations to Gram matrices. We will give a brief overview of their method in general, and then elaborate on how it applies to our case in particular. Let $\M\in\R^{n\times m}$ be a gram matrix. Using the probability distribution $F(i) = \M(i,i)^2 / \tr(\M^2)$ sample $a\leq m$ columns of $\M$ independently at random and with replacement, where $a$ is some given parameter. Let $I\subset[n]$, $|I|\leq a$, be the indices of sampled columns. Let $\bC\in\R^{n\times a}$ be the matrix formed by these columns (that is, $\bC=\M(\cdot,I)$).  Let $\Q$ be the matrix $\M(I,I)\in\R^{a\times a}$, i.e., the submatrix of $M$ with entries corresponding to indices in $I$, and $\Q^+_k$  the optimal rank $k$-approximation to $\Q^+$, the pseudoinverse of $\Q$ (section \ref{sec:background_pseudoinverse}). The low rank approximation to $\M$ is then 
\begin{equation*}
\tM \equiv \bC\M(I,I)_k^+\bC^\tp.
\end{equation*}

\begin{theorem}[\cite{drineas2005approximating}]
	Let $\M$ be a gram matrix and let $\tM$ be as above. Let $\eps>0$,  $k\leq c\in\N$. If $c=\Omega(k/\eps^4)$, then 
	\begin{equation*}
	\norm{\M-\tM}_\kappa \leq \norm{\M-\M_k}_\kappa + \eps \tr(\M^2),
	\end{equation*}
	for $\kappa=2,F$. 
\end{theorem}

Let us analyze how this result translates to the case when $\M=\L_G$. Let $I$ and $\bC$ be as above. First we observe that $\L_G(I,I)$ is simply the Laplacian on the subgraph $G[I]$. Put $\tG = G[I]$. Performing an eigendecomposition, write 
\begin{equation*}
\L_\tG = \sum_{r=1}^{|I|} \mu_r \bnu_r\bnu_r^\tp,
\end{equation*}
for where $\mu_1\geq \mu_2\geq \dots \geq \mu_{|I|}=0$ and $\{\bnu_r\}$ are the eigenvalues and eigenvectors of $\L_\tG$, respectively. The results of Section \ref{sec:background_pseudoinverse} then dictate that 
\begin{equation*}
\L_\tG^+ = \sum_{r=1}^{|I|} \frac{1}{\mu_r} \bnu_r\bnu_r^\tp,
\end{equation*}
and so the best rank $k$ approximation to $\L_\tG$ is given by 
\begin{equation*}
\L_k \equiv (\L_\tG^+)_k = \sum_{r=1}^{k} \frac{1}{\mu_r} \bnu_r\bnu_r^\tp.
\end{equation*}
The approximation for $\L_G$ is thus given by $\tL=\bC\L_k\bC^\tp=\bC\L_k^{1/2}\L_k^{\tp/2}\bC^\tp = (\L_k^{\tp/2}\bC^\tp)^\tp \L_k^{\tp/2}\bC^\tp$. That is, we can view $\tL$ as the gram matrix of the vectors given by the columns of $\tSv =  (\L_k^{\tp/2}\bC^\tp)$. 

Let us examine $\tSv^\tp=\C\L_k^{\tp/2}$. First consider $\rank(\bC)$, which we claim is $|I|$. Suppose $\bC\f=\zero$, where $\f:I \to \R$. Extend $\f$ to $\hf:[n]\to\R$ by setting $\hf(u)=0$ for all $u\in [n]\setminus I$. Then 
\[(\L_G\hf)(k) = \sum_{i\in[n]}\L_G(k,i)\hf(i) = \sum_{i\in I}\L_G(k,i) \f(i) + \sum_{i\in[n]\setminus I} \L_G(k,i)\hf(i) = \sum_{i\in I}\bC(k,i) \f(i) = 0,\]
implying that $\L_G\hf=\zero$, so $\hf\in\spn(\one))$. However, as long as $|I|\neq[n]$, this is impossible since  $\hf([n]\setminus I)=\zero$. Therefore, so long as $c<n$, we have $\rank(\bC) = c$. 
We now claim that $\rank(\bC\L_k^{\tp/2}) = \rank(\L_k^{\tp/2})$, which is easier to prove in the abstract. 

\begin{lemma}
	Let $\bS:\R^n\to\R^\ell$, $T\in\R^m\to\R^n$ be linear maps with $\rank(\bS)=\ell$. Then $\rank(\bS\T) = \rank(\T)$. 
\end{lemma}
\begin{proof}
	If $\T\f=\zero$ then clearly $\bS\T\f=\zero$ so $\dim\ker(\T)\leq \dim\ker(\bS\T)$. On the other hand, if $\bS\T\f=\zero$ then because $\bS$ is full rank, $\T\f=\zero$ implying that $\dim \ker \T\ge \ker\bS\T$. 	By the rank nullity Theorem (e.g., ~\cite{axler1997linear}) $\rank(\bS\T) + \dim\ker \bS\T = n = \rank(\T) + \dim\ker\T$ from which the result follows immediately. 
\end{proof}

Taking $\bC=\bS$ and $\T=\L_k^{\tp/2}$ in the above lemma gives that $\rank(\bC\L_k^{\tp/2})=k$. Consequently, the vertex matrix $\tSv\in\R^{|I|\times n}$ contains $n$ vectors in $\R^{|I|}$. Moreover, 
\[\rank(\tL) = \rank(\tSv^\tp \tSv) = \rank(\tSv)=k,\]
meaning the $n$ vectors span a $k$-dimensional space. 

One might hope that the approximation matrix $\tL$ was a Laplacian, but this does not seem to be the case in general. While it is true that $\tL(i,i)\geq 0$ (by virtue of being a gram matrix) and that $\tL\one=\zero$ (this follows since $\bC^\tp\one =\zero$ because the rows of $\bC^\tp$ are columns and hence rows of $\L_G$). However, 
\[\tL(i,j) = \sum_{r,s=1}^c \bC(i,r)\bC(j,s)\L_k(r,s),\]
which does not look to be necessarily non-positive. 





\subsection{Embedding \texorpdfstring{$\splx$}{the simplex} in lower dimensions}
Johnson-Lindenstrauss Lemma~\cite{johnson1984extensions,dasgupta2003elementary}: 

\begin{theorem}[Johnson-Lindenstrauss Lemma]
Let $E\subset \R^k$ be a set of $n$ points, for some $k\in\N$. For any $\eps>0$ and $d\geq 8\log(n)\eps^{-2}$ there exists a map $g_\eps:\R^k\to\R^d$ such that 
\begin{equation*}
    (1-\eps)\norm{\u-\v}_2^2 \leq \norm{g_\eps(\u) - g_\eps(\v)}_2^2 \leq (1+\eps)\norm{\u-\v}_2^2,
\end{equation*}
for all $\u,\v\in E$. 
\end{theorem}

\begin{theorem}[\cite{spielman2011graph}]
For any $\eps>0$ and graph $G=(V,E,w)$, there exists an algorithm which computes a matrix $\widetilde{\Reff}\in\R^{O(\log(n)\eps^{-2})\times n}$ such that 
\begin{equation*}
    (1-\eps)r(i,j) \leq \norm{\widetilde{\Reff}(\bchi_i-\bchi_j)}_2^2 \leq (1+\eps) r(i,j).
\end{equation*}
The algorithm runs in time $\widetilde{O}( |E|\log (r)/\eps^2)$, where 
\[r=\frac{\max_{i,j}w(i,j)}{\min_{i,j}w(i,j)}.\]
\end{theorem}

Consider inverse simplex for which we have $\norm{\sv_i^+-\sv_j^+}_2^2=r(i,j)$ where $r(i,j)$ is the effective resistance between vertices $i$ and $j$. Add a point $\o$ which is the centroid of these points. Thus $\norm{\sv_i^+-\o}_2^2 = \L_G^+(i,i)$ for all $i$. Note that we can compute this in linear time since 
\[\norm{\sv_i^+-\o}_2^2 = \norm{\sv_i^+}_2^2 = \frac{1}{W(\delta(\{i\}))}=\frac{1}{w(i)}.\]

Applying JL transform to obtain $n+1$ points in $\R^d$, for $d=O(\log(n)/\eps^2)$. Let $f$ be the mapping, e.g., $\sv_i^+$ mapped to $f(\sv_i^+)$. By JL, have 

\[(1-\eps)\norm{\x-\y}_2^2\leq  \norm{f(\x) -f(\y)}_2^2\leq (1+\eps)\norm{\x-\y}_2^2, \]
for all $\x,\y\in \{\sv_1^+,\dots,\sv_n^+,\o\}$. 
Apply a linear transformation to the points so that $f(\o)$ coincides with the origin $\zero\in\R^d$. Note that this does not affect the distances between the points themselves, and does not damage the approximation. Update $f$ to reflect this transformation. Then, 
\[\norm{f(\sv_i^+)}_2^2 = \norm{f(\sv_i^+)-f(\o)}_2^2 = (1+\eps_{i,\o})\norm{\sv_i^+-\o}_2^2 = (1+\eps_{i,\o})\L_G^+(i,i).\]
Hence, 
\begin{align*}
    \norm{f(\sv_i^+)-f(\sv_j+)}_2^2 &= \la f(\sv_i^+)-f(\sv_j^+),f(\sv_i^+)-f(\sv_j+)\ra \\
    &= \norm{f(\sv_i^+)}_2^2 + \norm{f(\sv_j^+)}_2^2 - 2\la f(\sv_i^+),f(\sv_j^+)\ra,  
\end{align*}
implying that 
\begin{align*}
    \la f(\sv_i^+),f(\sv_j^+) \ra &= -\frac{1}{2} \bigg((1+\eps_{i,j})\norm{\sv_i^+-\sv_j^+}_2^2 - (1+\eps_{i,\o})\L_G^+(i,i) - (1+\eps_{j,\o})\L_G^+(j,j)\bigg) \\
    &= -\frac{1}{2}((1+\eps_{i,j})r(i,j) - (1+\eps_{i,\o})\L_G^+(i,i) - (1+\eps_{j,\o})\L_G^+(j,j)) \\
    &= -\frac{1}{2}((1+\eps_{i,j})(\L_G^+(i,i) - \L_G^+(j,j) - 2\L_G^+(i,j)) \\
    &\hspace{2cm}- (1+\eps_{i,\o})\L_G^+(i,i) - (1+\eps_{j,\o})\L_G^+(j,j))\\
    &= (1+\eps_{i,j})\L_G^+(i,j) + \varepsilon(i,j),
\end{align*}
where 
\[\varepsilon(i,j)\equiv \frac{1}{2}(\eps_{i,\o}-\eps_{i,j})\L_G^+(i,i) + (\eps_{j,\o}-\eps_{i,j})\L_G^+(i,j),\]
is an error term dictated by $\eps_{i,j}, \eps_{i,\o}$ and $\eps_{j,\o}$. Setting 
\[M\equiv \max_i \L_G^+(i,i),\]
we can bound the error term via repeated applications of the triangle inequality: 
\begin{align*}
    |\varepsilon(i,j)|& \leq \frac{1}{2}\bigg(|(\eps_{i,\o}-\eps_{i,j})\L_G^+(i,i)| + |(\eps_{j,\o}-\eps_{i,j})\L_G^+(i,j|\bigg) \\
    & \leq \frac{1}{2}\bigg([|\eps_{i,j}|+|\eps_{i,\o}|]\L_G^+(i,i) + [|\eps_{i,j}|+|\eps_{j,\o}|]\L_G^+(j,j)\bigg) \\
    &\leq \frac{1}{2} ( 2\eps\L_G^+(i,i) + 2\eps\L_G^+(j,j) ) \leq 2\eps M,
\end{align*}
since $|\eps_{i,j}|, |\eps_{i,\o}|,|\eps_{j,\o}|\leq |\eps|$. Setting $f(\Sv^+) = (f(\sv_1^+),\dots,f(\sv_n^+))\in \R^{d\times n}$, this approximation implies that 
\begin{equation*}
    \L_G^+ - O(\eps M)\I \leq f(\Sv^+)^\tp f(\Sv^+) \leq \L_G^+ + O(\eps M)\I. 
\end{equation*}
In other words, we can approximately recover the Gram matrix $\L_G^+=\Sv^+\Sv^+$ using the lower dimensional matrix $f(\Sv^+)$. 

Given a graph $G=(V,E,w)$, we can compute all the approximate distances $\norm{\sv_i^+-\sv_j^+}_2^2=r(i,j)$ in time \[\widetilde{O}(|E|\log (r)/\eps^2)+O(|E| \log(n)/\eps^2)=\widetilde{O}(|E|/\eps^2),\]
assuming $r=O(1)$. Note that we can compute a single effective resistance in time $O(\log n/\eps^2)$, since it involves simply computing the $\ell_2$ norm the vector $\widetilde{\Reff}(\bchi_i-\bchi_j)$ which is simply the difference of two columns of $\widetilde{\Reff}$. 
\note{Question: Does JL Lemma work with approximate distances??} 

\note{Possible reduction techniques: (1) Projection of simplex onto subspace $\R^k\subset \R^n$, probably either the subspace corresponding to largest or smallest eigenvalues. (2) Graph Sparsification: Keeps the same dimension, but removes many edges, i.e., many vertices becomes orthogonal. (3) JL Lemma approach. }

\note{Obviously the JL embedding approach does not maintain the fact that the dot product between non-neighbours is zero. But does it approximate this information? I.e., is the dot product smaller for non-neighbours than it is for neighbours?}

\note{For example, it maintains approximate information about random spanning trees. We know that 
\[\norm{\sv_i^+-\sv_j^+}_2^2 = \frac{1}{w(i,j)} \Pr_{T\sim \mu}[(i,j)\in T],\]
where $\mu$ is the uniform distribution over all spanning trees. Hence the new JL body approximately maintains this information. 
}


\note{Another thought, about how to do the embedding quickly:  Karel says that replacing $\lambda_j$ with $\lambda_j^{1/2}$ still yields a Laplacian,  i.e., $f(\L_G) = \Eig f(\Eval)\Eig^\tp = \sum_i f(\lambda_i)\vp_i\vp_i^\tp$
with $f(x)=\sqrt{x}$ is still a Laplacian. What's the graph which corresponds to this Laplacian?  Can we get to that graph from  the original graph, without calculating eigendecomposition?
Let this  graph be $G'$. Then  $\L^+_{G'}=\L_G^{+/2}$,  implying that by Spielman Teng we can get a good approximation of $\L_G^{+/2}$  (if we can compute  $G'$ quickly). Thus, we can get an approximate resistive embedding. Perhaps we can  then  get an approximate simplex from the  resistive embedding by projection onto appropriate  subspace (really need to figure out what  this subspace  is). 
}



\subsection{Resistive Embedding}

Notice that the effective resistance is encoded naturally by the simplex $\splx(G)$: 
\[\effr(i,j) = \la \bchi_i-\bchi_j,\L_G^+(\bchi_i-\bchi_j\ra = \la \Sv^+(\bchi_i,\bchi_j),\Sv^+(\bchi_i-\bchi_j)\ra = \norm{\sv_i^+-\sv_j^+}_2^2.\]
That is, the distance between the vertices of the inverse simplex are precisely the effective resistances. 


Consider the vertices $\bmu_i=\L_G^{+/2}\bchi_i\in\R^n$, for $i\in[n]$. This yields $n$ points in $\R^n$, also with pairwise squared distances equal to the effective resistance of the graph: 

\begin{equation*}
    \norm{\bmu_i-\bmu_j}_2^2 = \norm{\L_G^{+/2}(\bchi_i-\bchi_j)}_2^2 =  (\bchi_i-\bchi_j)^\tp \L_G^+(\bchi_i-\bchi_j)=\effr(i,j).
\end{equation*}

\begin{claim}
\note{Sort this out. Seems true but should make sure.} The polytope defined by the vertices $\{\bmu_i\}$ sits in an $n-1$ dimensional subspace. That  is, there exists a linear map $\T:\R^n\to\R^{n-1}$ such that $\T\bmu\subset\R^{n-1}$ is a simplex.
\end{claim}

Based on above, should have  that $\T\bmu$ is a shifted/rotated/reflected copy of $\splx$. So there exists a map $\M:\R^{n-1}\to\R^{n-1}$ such that $\M\T\bmu=\Sv$. 

We have 
\begin{align*}
    \mu_i(\ell) = \L_G^{+/2}(\ell,i) = \sum_{j\in[n]}\lambda_j^{-1/2}\vp_j\vp_j^\tp(\ell,i) = \sum_{j\in[n]}\lambda_j^{-1/2}\vp_j(\ell)\vp_j(i).
\end{align*}
Recalling the formula for the vertices of the inverse simplex $\splx^+$ demonstrates that 
\begin{equation*}
    \mu_i(\ell) = \sum_{j\in[n]}\sv_\ell^+(j)\vp_j(i) = \sum_{j\in[n]}\sv_i^+(j)\vp_j(\ell).
\end{equation*}

Moreover,

\begin{align*}
    \la \bmu_i,\bmu_j\ra &=\sum_{\ell\in[n]} \L_G^{+/2}(\ell,i)\L_G^{+/2}(\ell,j) = \la \L_G^{+/2}(\cdot,i),\L_G^{+/2}(\cdot,j)\ra =\la \L_G^{+/2}(\cdot,i),\L_G^{+/2}(j,\cdot)\ra= \L_G^+(i,j),
\end{align*}
since $\L_G^{+/2}$ is symmetric and  $\L_G^{+/2}\L_G^{+/2}=\L_G^+$.  We can also see this from recalling that 
\[\effr(i,j) = \L_G^+(i,i) + \L_G^+(j,j) - \frac{1}{2}\L_G^+(i,j),\]
combined with the facts that $\norm{\bmu_i-\bmu_j}_2^2 = \effr(i,j)$ and $\norm{\bmu_i}_2^2 = \L_G^+(i,i)$. 



\note{If we can  figure  out the map which  projects the polyhedron onto the correct subspace,  the relationships of the simplex will hold and we can maybe use this to discover interesting eigenvector/eigenvalue properties. } 

Let $\re=\conv(\bmu_1,\dots,\bmu_n)$ be the convex polygon defined by the vertices $\{\bmu_i\}$.  Note that $\L_G^{+/2}$ is $\re$'s associated vertex matrix. 

The centroid of $\re$ coincides with the origin  of $\R^n$: 
\begin{equation*}
    \cent(\re) = \frac{1}{n}\L_G^{+/2}\one = \frac{1}{n}\sum_{i\in[n-1]}\lambda_i^{-1/2}\vp_i\vp_i^\tp \one = \zero.
\end{equation*}

\begin{lemma}
The all ones vector is orthogonal to $\re$. 
\end{lemma}
\begin{proof}
We need to show that for all $\p,\q\in\re$, $\la \one,\p-\q\ra=0$. As usual, let $\x$ and $\y$ be the barycentric coordinates of $\p$ and $\q$ so that $\p=\L_G^{+/2}\x$ and $\q=\L_G^{+/2}\y$. We have
\begin{align*}
    \la \one,\p\ra &= \sum_{\ell\in[n]} (\L_G^{+/2}\x)(\ell) = \sum_{\ell\in[n]} \sum_{j\in [n]}\L_G^{+/2}(\ell,j)x(j) = \sum_{j\in[n]}x(j) \sum_{\ell\in[n]}\L_G^{+/2}(\ell,j),
\end{align*}
where for any $j$, 
\[\sum_{\ell\in[n]}\L_G^{+/2}(\ell,j)= \one^\tp \L_G^{+/2}\bchi_j=\sum_{\ell\in[n-1]} \lambda_\ell^{-1/2}\one^\tp \vp_\ell\vp_\ell^\tp\bchi_j=0,\]
since $\vp_i\in\spn(\one)^\perp$  for all $i<n$. Hence  $\la \one,\p\ra=0$ meaning that $\la \one,\p-\q\ra=0$ as well. 
\end{proof}

The relationship between $\re$ and $\splx$ gives us an alternate way to prove equalities such as \eqref{eq:c(S_U)}. Indeed, there exists an isometry between $\re$ and $\splx$; therefore, 
\begin{equation*}
    \norm{\cent(\splx_U)}_2^2 = \norm{\cent(\re_U)}_2^2 = \frac{1}{|U|^2} \norm{\L_G^{+/2}\bchi_U}_2^2 = \frac{1}{|U|^2}w(\delta^+ U).
\end{equation*}


\note{What is the ``inverse'' of $\re$?? This inverse will relate to a lot of graph properties. If we can obtain a closed form analytical expression this could yield new relationships}. 

\note{Answer: Inverse simply has vertices $\L_G^{1/2}\bchi_i$}. 

